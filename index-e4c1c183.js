(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function s(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?a.credentials="include":e.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(e){if(e.ep)return;e.ep=!0;const a=s(e);fetch(e.href,a)}})();document.getElementById("capturedHeading");document.getElementById("currentHeading");document.getElementById("alphaDeg");const o=document.getElementById("container"),C=document.getElementById("searchcity"),x=document.getElementById("hum"),L=document.getElementById("pres"),D=document.getElementById("search"),P=document.getElementById("tempcelcius"),A=document.getElementById("weathericon"),O=document.getElementById("description"),q=document.getElementById("zone"),y=document.getElementById("plus"),l=document.getElementById("cristal"),d=document.getElementById("cristal2"),M=document.getElementById("date"),S=document.getElementById("min"),H=document.getElementById("max"),N=document.getElementById("windvel"),z=document.getElementById("winang"),W=document.getElementById("gps"),$=document.getElementById("compass"),p=document.getElementById("compbt"),i="a00065117a35d1c18108761088dca9fa",g="https://api.openweathermap.org/data/2.5/weather?lang=sp&units=metric",K="https://api.openweathermap.org/data/2.5/weather?";let m=0,h=0,w,u=0;const c=t=>{const n=new Date(t.dt*1e3);new Date(t.sys.sunrise*1e3),new Date(t.sys.sunset*1e3);const s=n.getHours().toString().padStart(2,"0"),r=n.getMinutes().toString().padStart(2,"0");M.textContent=`${s}:${r}`,t.dt>t.sys.sunrise&&t.dt<t.sys.sunset?(o.classList.remove("night"),o.classList.add("day")):(o.classList.remove("day"),o.classList.add("night")),q.textContent=t.name+" "+t.sys.country,P.textContent=Math.floor(t.main.temp),O.textContent=t.weather[0].description,S.textContent=Math.floor(t.main.temp_min),H.textContent=Math.floor(t.main.temp_max),z.style.transform="rotate("+t.wind.deg+"deg)",N.textContent=t.wind.speed,x.textContent=t.main.humidity,L.textContent=t.main.pressure/1e3;const e=t.weather[0].icon;A.innerHTML=`<img src="./icons/${e}.png"></img>`},E=async t=>{try{return await(await fetch("http://ip-api.com/json/?fields=61439")).json()}catch{const s=navigator.language.split("-")[1];t==null?v("la roda, ES"):v(t+", "+s)}};function B(t){w=t.coords,h=0,R(w)}const I=async t=>{h=1;const n=await E();v(n.city+", "+n.countryCode)};navigator.geolocation.getCurrentPosition(B,I);const v=async t=>{if(t.includes(",")){const s=await(await fetch(g+"&appid="+i+"&q="+t)).json();if(s.message=="city not found"){const r=t.split(",")[0],a=await(await fetch(g+"&appid="+i+"&q="+r)).json();c(a)}else c(s)}else if(h===0){const s=await(await fetch("http://api.openweathermap.org/geo/1.0/reverse?lat="+w.latitude+"&lon="+w.longitude+"&limit=1&appid="+i)).json(),e=await(await fetch(g+"&appid="+i+"&q="+t+", "+s[0].country)).json();if(e.message=="city not found"){const f=await(await fetch(g+"&appid="+i+"&q="+t)).json();c(f)}else c(e);c(e)}else if(h===1){const n=await E(t),r=await(await fetch(g+"&appid="+i+"&q="+t+", "+n.countryCode)).json();if(r.message=="city not found"){const a=await(await fetch(g+"&appid="+i+"&q="+t)).json();c(a)}else c(r)}},R=async t=>{const n=t.longitude,s=t.latitude,a=await(await fetch(K+"lat="+s+"&lon="+n+"&appid="+i+"&lang=sp&units=metric")).json();c(a)};C.addEventListener("submit",t=>{t.preventDefault(),v(D.value)});y.addEventListener("click",t=>{t.preventDefault(),u===0?m===0?(l.style.transform=" translate(0, 6rem)",o.style.transform="translate(0, -6rem)",d.style.transform="translate(0, -6rem)",m=1,y.textContent="-"):(l.style.transform=" translate(0, 0rem)",o.style.transform="translate(0, -0rem)",d.style.transform="translate(0, -0rem)",m=0,y.textContent="+"):m===0?(l.style.transform=" translate(0, 10rem)",o.style.transform="translate(0, -2rem)",d.style.transform="translate(0, -13rem)",m=1,y.textContent="-"):(l.style.transform=" translate(0, 1rem)",o.style.transform="translate(0, 1rem)",d.style.transform="translate(0, -10rem)",m=0,y.textContent="+")});W.addEventListener("click",t=>{t.preventDefault(),navigator.geolocation.getCurrentPosition(B,I)});p.addEventListener("click",t=>{t.preventDefault(),m===0?u===0?(l.style.transform=" translate(0, 1rem)",o.style.transform="translate(0, 1rem)",d.style.transform="translate(0, -10rem)",u=1,p.style.opacity="1"):(l.style.transform=" translate(0, 0rem)",o.style.transform="translate(0, -0rem)",d.style.transform="translate(0, -0rem)",u=0,p.style.opacity=".5"):u===0?(l.style.transform=" translate(0, 10rem)",o.style.transform="translate(0, -2rem)",d.style.transform="translate(0, -13rem)",u=1,p.style.opacity="1"):(l.style.transform=" translate(0, 1rem)",o.style.transform="translate(0, 1rem)",d.style.transform="translate(0, -10rem)",u=0,p.style.opacity=".5")});(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(p.style.opacity=".5");function U(){navigator.geolocation&&window.DeviceOrientationEvent?navigator.geolocation.getCurrentPosition(function(t){window.addEventListener("deviceorientationabsolute",function(n){const r=360-n.alpha,e=0-Math.round(r*100)/100%360;console.log("Dirección del norte geográfico: "+e+" grados"),$.style.transform="rotate("+e+"deg)"})}):console.log("La geolocalización o la brújula no son compatibles con este navegador.")}U();
